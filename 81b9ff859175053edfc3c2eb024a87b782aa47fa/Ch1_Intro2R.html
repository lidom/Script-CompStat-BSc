<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.5.57" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />


<title>1  R-Lab: Introduction to R – Computer-Aided Statistical Analysis (B.Sc.)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<!-- htmldependencies:E3FAD763 -->
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn"
      data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" 
      aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
      onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <h1 class="quarto-secondary-nav-title no-breadcrumbs"></h1>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" role="link"
        aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
        onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="/index.html" class="sidebar-logo-link">
      <img src="/images/Uni_Bonn_Logo.jpeg" alt="" class="sidebar-logo py-0 d-lg-inline d-none"/>
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="/">
      Computer-Aided Statistical Analysis (B.Sc.)
      </a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Organization of the Course</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/Ch1_Intro2R.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class='chapter-number'>1</span>  <span class='chapter-title'>`R`-Lab: Introduction to `R`</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/Ch4_LinearRegression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>2</span>  <span class='chapter-title'>Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/Ch3_MatrixAlgebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>3</span>  <span class='chapter-title'>Matrix Algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/Ch5_Classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>4</span>  <span class='chapter-title'>Classification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/Ch6_ResamplingMethods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>5</span>  <span class='chapter-title'>Resampling Methods</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" ></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <div id="quarto-toc-target"></div>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>  <span class="chapter-title"><code>R</code>-Lab: Introduction to <code>R</code></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#short-glossary" id="toc-short-glossary"><span class="header-section-number">1.1</span> Short Glossary</a></li>
  <li><a href="#first-steps" id="toc-first-steps"><span class="header-section-number">1.2</span> First Steps</a></li>
  <li><a href="#further-data-objects" id="toc-further-data-objects"><span class="header-section-number">1.3</span> Further Data Objects</a></li>
  <li><a href="#programming-in-r" id="toc-programming-in-r"><span class="header-section-number">1.4</span> Programming in <code>R</code></a>
  <ul>
  <li><a href="#simulating-data" id="toc-simulating-data"><span class="header-section-number">1.4.1</span> Simulating Data</a></li>
  </ul></li>
  <li><a href="#r-packages" id="toc-r-packages"><span class="header-section-number">1.5</span> <code>R</code>-Packages</a></li>
  <li><a href="#self-study-tidyverse" id="toc-self-study-tidyverse"><span class="header-section-number">1.6</span> Self-Study: Tidyverse</a>
  <ul>
  <li><a href="#self-study-tidyverse-plotting-basics" id="toc-self-study-tidyverse-plotting-basics"><span class="header-section-number">1.6.1</span> Self-Study: Tidyverse Plotting Basics</a></li>
  <li><a href="#self-study-tidyverse-data-wrangling-basics" id="toc-self-study-tidyverse-data-wrangling-basics"><span class="header-section-number">1.6.2</span> Self-Study: Tidyverse Data Wrangling Basics</a></li>
  </ul></li>
  <li><a href="#self-study-gitgithub" id="toc-self-study-gitgithub"><span class="header-section-number">1.7</span> Self-Study: Git/GitHub</a></li>
  <li><a href="#in-class-coding-exercise-oct.-20" id="toc-in-class-coding-exercise-oct.-20"><span class="header-section-number">1.8</span> In Class Coding Exercise (Oct. 20)</a></li>
  </ul>
</nav>
<!-- LTeX: language=en-US -->
<p>This tutorial aims to serve as an introduction to the software package <code>R</code>. Other very good and much more exhaustive tutorials and useful reference-cards can be found at the following links:</p>
<ul>
<li><a href="http://cran.r-project.org/doc/contrib/refcard.pdf">Reference card for R commands</a> (always useful)</li>
<li><a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.pdf">The official Introduction to R</a> (very detailed)</li>
<li>And many more at <a href="https://www.r-project.org/other-docs.html">www.r-project.org</a> (see “Documents”) <!-- *  An interactive introduction can be done online at: [www.datacamp.com](https://www.datacamp.com/) --></li>
<li>An R-package for learning R: <a href="https://swirlstats.com/">www.swirl.com</a></li>
<li>An excellent book project which covers also advanced issues such as “writing performant code” and “package development”: <a href="http://adv-r.had.co.nz/">adv-r.had.co.nz</a><br />
</li>
<li>Another excellent book: <a href="https://r4ds.had.co.nz/">R for Data Science</a></li>
</ul>
<p>Some other tutorials:</p>
<ul>
<li><a href="https://idc9.github.io/stor390/">Introduction to data science</a></li>
<li><a href="https://gganimate.com/">Creating dynamic graphics</a></li>
</ul>
<p>Why <code>R</code>?</p>
<ul>
<li><code>R</code> is <strong>free</strong> of charge from: <a href="https://www.r-project.org/">www.r-project.org</a></li>
<li>The IDE <strong>RStudio</strong> for R is <strong>free</strong> of charge: <a href="http://www.rstudio.com/">www.rstudio.com</a></li>
<li>The IDE <strong>Positron</strong> for R is <strong>free</strong> of charge: <a href="https://positron.posit.co/">https://positron.posit.co/</a></li>
<li>R is equipped with one of the most flexible and powerful graphics routines available anywhere. For instance, check out one of the following repositories:
<ul>
<li><a href="http://shinyapps.org/apps/RGraphCompendium/index.php">Clean Graphs</a></li>
<li><a href="http://www.sthda.com/english/rpkgs/ggpubr/">Publication Ready Plots</a></li>
</ul></li>
<li>Today, R is the de-facto standard for statistical science.</li>
</ul>
<section id="short-glossary" class="level2" data-number="1.1">
<h2 data-number="1.1"><span class="header-section-number">1.1</span> Short Glossary</h2>
<p>Lets start the tutorial with a (very) short glossary:</p>
<ul>
<li><strong>Console</strong>: The thing with the <code>&gt;</code> sign at the beginning.</li>
<li><strong>Script file</strong>: An ordinary text file with suffix <code>.R</code>. For instance, <code>yourFavoritFileName.R</code>.</li>
<li><strong>Working directory</strong>: The file-directory you are working in. Useful commands: with <code>getwd()</code> you get the location of your current working directory and <code>setwd()</code> allows you to set a new location for it.</li>
<li><strong>Workspace</strong>: This is a hidden file (stored in the working directory), where all objects you use (e.g., data, matrices, vectors, variables, functions, etc.) are stored. Useful commands: <code>ls()</code> shows all elements in our current workspace and <code>rm(list=ls())</code> deletes all elements in our current workspace.</li>
</ul>
</section>
<section id="first-steps" class="level2" data-number="1.2">
<h2 data-number="1.2"><span class="header-section-number">1.2</span> First Steps</h2>
<p>A good idea is to use a script file such as <code>yourFavoritFileName.R</code> in order to store your <code>R</code> commands. You can send single lines or marked regions of your R-code to the console by pressing the keys <strong>STRG+ENTER</strong>.</p>
<p>To begin with baby steps, do some simple computations:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span> <span class="co"># and all the others: *,/,-,^2,^3,... </span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Note: Everything that is written after the <code>#</code>-sign is ignored by <code>R</code>, which is very useful to comment your code.</p>
<p>The <strong>assignment operator</strong> <code>&lt;-</code> or <code>=</code> will be your most often used tool. Here an example to create a <strong>scalar</strong> variable:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">4</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="ot">-&gt;</span> x <span class="co"># possible but unusual</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Note: The <code>R</code> community loves the <code>&lt;-</code> assignment operator, which is a very unusual syntax. Alternatively, you can use the more common <code>=</code> operator which is also used in languages like python or matlab.</p>
<p>And now a more interesting object - a <strong>vector</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 7 4 1</code></pre>
</div>
</div>
<p>The command <code>ls()</code> shows the total content of your current workspace, and the command <code>rm(list=ls())</code> deletes all elements of your current workspace:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;x&quot; &quot;y&quot;</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
</div>
<p>Note: RStudio’s <strong>Environment</strong> pane also lists all the elements in your current workspace. That is, the command <code>ls()</code> becomes a bit obsolete when working with RStudio.</p>
<p>Let’s try how we can compute with vectors and scalars in R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>x<span class="sc">*</span>y <span class="co"># each element in the vector, y, is multiplied by the scalar, x.</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8 28 16  4</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>y<span class="sc">*</span>y <span class="co"># this is a term by term product of the elements in y</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  4 49 16  1</code></pre>
</div>
</div>
<p>Performing vector multiplications as you might expect from your last math-course, e.g., an outer product: <span class="math inline">\(y\,y^\top\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">%*%</span> <span class="fu">t</span>(y)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    4   14    8    2
[2,]   14   49   28    7
[3,]    8   28   16    4
[4,]    2    7    4    1</code></pre>
</div>
</div>
<p>Or an inner product <span class="math inline">\(y^\top y\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(y) <span class="sc">%*%</span> y</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   70</code></pre>
</div>
</div>
<p>Note: Sometimes, R’s treatment of vectors can be annoying. The product <code>y %*% y</code> is treated as the product <code>t(y) %*% y</code>.</p>
<p>The term-by-term execution as in the above example, <code>y*y</code>, is actually a central strength of R. We can conduct many operations <strong>vector-wisely</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>y<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  4 49 16  1</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(y)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6931472 1.9459101 1.3862944 0.0000000</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(y)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    7.389056 1096.633158   54.598150    2.718282</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>y<span class="sc">-</span><span class="fu">mean</span>(y)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.5  3.5  0.5 -2.5</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(y<span class="sc">-</span><span class="fu">mean</span>(y))<span class="sc">/</span><span class="fu">sd</span>(y) <span class="co"># standardization </span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5669467  1.3228757  0.1889822 -0.9449112</code></pre>
</div>
</div>
<p>This is a central characteristic of so called matrix based languages like R (or Matlab). Other programming languages often have to use <strong>loops</strong> instead:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span>N</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>y.sq <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>y.sq</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  y.sq[i] <span class="ot">&lt;-</span> y[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> N){</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(y.sq)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>The <code>for()</code>-loop is the most common loop. But there is also a <code>while()</code>-loop and a <code>repeat()</code>-loop. However, loops in R can be rather slow, therefore, try to avoid them!</p>
<!-- Try to write your own loop, which computes the element-wise logarithms of a vector `y` and finally prints these values as well as their mean!  -->
<p>Useful commands to produce <strong>sequences</strong> of numbers:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>?seq <span class="co"># Help for the seq()-function</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>, <span class="at">to=</span><span class="dv">100</span>, <span class="at">by=</span><span class="dv">7</span>)</span></code></pre></div>
</div>
<p>Using the sequence command <code>1:16</code>, we can go for our first <strong>matrix</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>?matrix</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    5    9   13
[2,]    2    6   10   14
[3,]    3    7   11   15
[4,]    4    8   12   16</code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span></code></pre></div>
</div>
<p>Note that a matrix has always two <strong>dimensions</strong>, but a vector has only one dimension:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(A)    <span class="co"># Dimension of matrix A?</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 4</code></pre>
</div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(y)    <span class="co"># dim() does not operate on vectors.</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(y) <span class="co"># Length of vector y?</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Lets play a bit with the matrix <code>A</code> and the vector <code>y</code>. As we have seen in the loop above, the <code>[]</code>-operator <strong>selects elements</strong> of vectors and matrices:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb42"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>A[,<span class="dv">1</span>]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">4</span>,<span class="dv">4</span>]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>y[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)]</span></code></pre></div>
</div>
<p>This can be done on a more <strong>logical</strong> basis, too. For example, if you want to know which elements in the first column of matrix <code>A</code> are strictly greater than 2:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>A[,<span class="dv">1</span>][A[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">2</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4</code></pre>
</div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that this give you a boolean vector:</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>A[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">2</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE  TRUE  TRUE</code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And you can use it in a non-sense relation, too:</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>y[A[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">2</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 1</code></pre>
</div>
</div>
<p>Note: Logical operations return so-called <strong>boolean</strong> objects, i.e., either a <code>TRUE</code> or a <code>FALSE</code>. For instance, if we ask R whether <code>1&gt;2</code> we get the answer <code>FALSE</code>.</p>
</section>
<section id="further-data-objects" class="level2" data-number="1.3">
<h2 data-number="1.3"><span class="header-section-number">1.3</span> Further Data Objects</h2>
<p>Besides classical data objects such as scalars, vectors, and matrices there are three further data objects in R:</p>
<ol type="1">
<li>The <strong>array</strong>: As a matrix but with more dimensions. Here is an example of a <span class="math inline">\(2\times 2\times 2\)</span>-dimensional <code>array</code>:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>myFirst.Array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co"># Take a look at it!</span></span></code></pre></div>
</div>
<ol start="2" type="1">
<li>The <strong>list</strong>: In <code>lists</code> you can organize different kinds of data. E.g., consider the following example:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb50"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>myFirst.List <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;Some_Numbers&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">66</span>, <span class="dv">76</span>, <span class="dv">55</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">66</span>, <span class="dv">8</span>, <span class="dv">99</span>), </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Animals&quot;</span>      <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Rabbit&quot;</span>, <span class="st">&quot;Cat&quot;</span>, <span class="st">&quot;Elefant&quot;</span>),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;My_Series&quot;</span>    <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">30</span><span class="sc">:</span><span class="dv">1</span>)) </span></code></pre></div>
</div>
<p>A very useful function to find specific values and entries within lists is the <code>str()</code>-function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(myFirst.List)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 3
 $ Some_Numbers: num [1:8] 66 76 55 12 4 66 8 99
 $ Animals     : chr [1:3] &quot;Rabbit&quot; &quot;Cat&quot; &quot;Elefant&quot;
 $ My_Series   : int [1:30] 30 29 28 27 26 25 24 23 22 21 ...</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>The <strong>data frame</strong>: A <code>data.frame</code> is a <code>list</code>-object but with some more formal restrictions (e.g., equal number of rows for all columns). As indicated by its name, a <code>data.frame</code>-object is designed to store data:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb53"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>myFirst.Dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Credit_Default&quot;</span>   <span class="ot">=</span> <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;Age&quot;</span>              <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">35</span>,<span class="dv">41</span>,<span class="dv">55</span>,<span class="dv">36</span>,<span class="dv">44</span>,<span class="dv">26</span>), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;Loan_in_1000_EUR&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">55</span>,<span class="dv">65</span>,<span class="dv">23</span>,<span class="dv">12</span>,<span class="dv">98</span>,<span class="dv">76</span>)) </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look at it!</span></span></code></pre></div>
</div>
<!-- 
## Simple Regression Analysis using R 

Alright, let's do some statistics with real data. You can download the data [HERE](https://github.com/lidom/Teaching_Repo). Save it on your computer, at a place where you can find it, and give the path (e.g. `"C:\textbackslash path\textbackslash auto.data.csv"`, which references to the data, to the *file*-argument of the function `read.csv()`:




::: {.cell layout-align="center"}

```{.r .cell-code}
# ATTENTION! YOU HAVE TO CHANGE "\" TO "/":
auto.data <- read.csv(file="C:/your_path/autodata.txt", header=TRUE)
head(auto.data)
```
:::








If you have problems to read the data into R, go on with these commands. (For this you need a working internet connection!):




::: {.cell layout-align="center"}

```{.r .cell-code}
# install.packages("readr")
library("readr")
auto.data <- suppressMessages(read_csv(file = "https://cdn.rawgit.com/lidom/Teaching_Repo/bc692b56/autodata.csv",col_names = TRUE))
# head(auto.data)
```
:::








You can select specific variables of the `auto.data` using the `$`-operator:




::: {.cell layout-align="center"}

```{.r .cell-code}
gasolin.consumption      <- auto.data$MPG.city
car.weight               <- auto.data$Weight
# Take a look at the first elements of these vectors:
head(cbind(gasolin.consumption,car.weight))
```

::: {.cell-output .cell-output-stdout}

```
     gasolin.consumption car.weight
[1,]                  25       2705
[2,]                  18       3560
[3,]                  20       3375
[4,]                  19       3405
[5,]                  22       3640
[6,]                  22       2880
```


:::
:::









This is how you can produce your first plot:





::: {.cell layout-align="center" fig.margin='true'}

```{.r .cell-code}
# Plot the data:
plot(y=gasolin.consumption, x=car.weight, 
     xlab="Car-Weight (US-Pounds)", 
     ylab="Consumption (Miles/Gallon)", 
     main="Buy Light-Weight Cars!")
```

::: {.cell-output-display}
![Scatterplot of Gasoline consumption (mpg) vs. car weight.](Ch1_Intro2R_files/figure-html/fig-margin-1.png){#fig-margin fig-align='center' width=432}
:::
:::








As a first step, we might assume a simple kind of linear relationship between the variables `gasolin.consumption` and `car.weight`. Let us assume that the data was generated by the following simple regression model: 
$$
y_i=\alpha+\beta_1 x_i+\varepsilon_i,\quad i=1,\dots,n
$$
where $y_i$ denotes the gasoline-consumption, $x_i$ the weight of car $i$, and $\varepsilon_i$ is a mean zero constant variance noise term. (This is clearly a non-sense model!) 

The command `lm()` computes the estimates of this linear regression model. The command (in fact it's a *method*) `summary()` computes further quantities of general interest from the *object* that was returned from the `lm()` function.




::: {.cell layout-align="center"}

```{.r .cell-code}
lm.result   <- lm(gasolin.consumption~car.weight)
lm.summary  <- summary(lm.result)
lm.summary
```

::: {.cell-output .cell-output-stdout}

```

Call:
lm(formula = gasolin.consumption ~ car.weight)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.7946 -1.9711  0.0249  1.1855 13.8278 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 47.048353   1.679912   28.01   <2e-16 ***
car.weight  -0.008032   0.000537  -14.96   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.038 on 91 degrees of freedom
Multiple R-squared:  0.7109,    Adjusted R-squared:  0.7077 
F-statistic: 223.8 on 1 and 91 DF,  p-value: < 2.2e-16
```


:::
:::








Of course, we want to have a possibility to access all the quantities computed so far, e.g., in order to plot the results. This can be done as following: 




::: {.cell layout-align="center" fig.margin='true'}

```{.r .cell-code}
# Accessing the computed quantities
names(lm.summary) # Alternatively: str(lm.summary)
```

::: {.cell-output .cell-output-stdout}

```
 [1] "call"          "terms"         "residuals"     "coefficients" 
 [5] "aliased"       "sigma"         "df"            "r.squared"    
 [9] "adj.r.squared" "fstatistic"    "cov.unscaled" 
```


:::

```{.r .cell-code}
alpha <- lm.summary$coefficients[1]
beta  <- lm.summary$coefficients[2]

# Plot all:
plot(y=gasolin.consumption, x=car.weight, 
     xlab="Car-Weight (US-Pounds)", 
     ylab="Consumption (Miles/Gallon)", 
     main="Buy light-weight Cars!")
abline(a=alpha, 
       b=beta, col="red")
```

::: {.cell-output-display}
![Scatterplot of Gasoline consumption (mpg) vs. car weight plus linear regression fit.](Ch1_Intro2R_files/figure-html/unnamed-chunk-23-1.png){fig-align='center' width=432}
:::
:::





-->
</section>
<section id="programming-in-r" class="level2" data-number="1.4">
<h2 data-number="1.4"><span class="header-section-number">1.4</span> Programming in <code>R</code></h2>
<section id="simulating-data" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1"><span class="header-section-number">1.4.1</span> Simulating Data</h3>
<p>Let’s write (i.e., program) our own <code>R</code>-function <code>myMean()</code> for computing the sample mean. In order to be able to validate our function, we start with <strong>simulating data</strong> for which we then know all the usually unknown true population parameters.</p>
<p>Simulating data is like being the “Data-God”: We can generate realizations of, for instance, a normal distributed random variable with a certain population mean <span class="math inline">\(\mu\)</span> and a certain population variance <span class="math inline">\(\sigma^2.\)</span></p>
<p>Let us consider the following setup:</p>
<ul>
<li><span class="math inline">\(X\sim \mathcal{N}(\mu,\sigma^2)\)</span></li>
<li><span class="math inline">\(\mu = 5\)</span></li>
<li><span class="math inline">\(\sigma^2=3\)</span></li>
<li><span class="math inline">\(X_1,\dots,X_n\)</span> being independent (of each other) and identically distributed as <span class="math inline">\(X;\)</span> in short <span class="math display">\[
X_1,\dots,X_n\overset{\text{iid}}{\sim} X
\]</span></li>
<li>Sample size <span class="math inline">\(n=100\)</span></li>
</ul>
<p>We can generate realizations of the random sample <span class="math display">\[
X_1,\dots,X_n
\]</span> using the following <code>R</code>-code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb54"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">109</span>) <span class="co"># Sets the &quot;seed&quot; of the random number generators:</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>n   <span class="ot">&lt;-</span> <span class="dv">100</span>    <span class="co"># Sample size</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drawing n iid realizations form a normal distr.</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>X_vec <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n    =</span> n, </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">mean =</span> <span class="dv">5</span>, </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">sd   =</span> <span class="fu">sqrt</span>(<span class="dv">3</span>))  </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># First three values</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(X_vec[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.61 7.15 5.43</code></pre>
</div>
</div>
<p>OK, we have now one possible realization of the random sample <span class="math display">\[
X_1,\dots,X_n
\]</span> namely <span class="math display">\[
X_{1,obs}=1.61,
X_{2,obs}=7.15,
X_{3,obs}=5.43,
\text{etc.}
\]</span></p>
<p>Using this observed realization of the random sample, we can estimate the usually unknown mean <span class="math inline">\(\mu=5\)</span> using the empirical mean <span class="math display">\[
\bar{X} = \frac{1}{n}\sum_{i=1}^n X_i
\]</span> namely, <span class="math display">\[
\bar{X}_{obs} = \frac{1}{n}\sum_{i=1}^n X_{i,obs} =5.34
\]</span></p>
<p>To do so, we program our own <code>myMean()</code>-function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb56"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>myMean <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  n           <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  sample_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)<span class="sc">/</span>n</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sample_mean)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>Applying the <code>myMean()</code>-function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb57"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">myMean</span>(X_vec)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.338722</code></pre>
</div>
</div>
<p>The observed realization of the sample mean <span class="math display">\[
\bar{X}_{obs}=5.34
\]</span> is close to the true (usually unknown) population mean <span class="math inline">\(\mu=5.\)</span></p>
</section>
</section>
<section id="r-packages" class="level2" data-number="1.5">
<h2 data-number="1.5"><span class="header-section-number">1.5</span> <code>R</code>-Packages</h2>
<p>One of the best features in R are its contributed packages. The list of all packages on CRAN is impressive! Take a look at it <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html">HERE</a></p>
<p>For instance, nice plots can be produced using the R-package is <code>ggplot2</code>. You can find an intro do this package <a href="http://ggplot2.tidyverse.org/">HERE</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb59"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;ggplot2&quot;)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(Sepal.Length, Petal.Length, <span class="at">data =</span> iris, <span class="at">color =</span> Species)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `qplot()` was deprecated in ggplot2 3.4.0.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="Ch1_Intro2R_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid quarto-figure quarto-figure-center" /></p>
</figure>
</div>
</div>
</div>
<p>Of course, <code>ggplot2</code> concerns “only” plotting, but you’ll find <code>R</code>-packages for almost any statistical method out there.</p>
</section>
<section id="self-study-tidyverse" class="level2" data-number="1.6">
<h2 data-number="1.6"><span class="header-section-number">1.6</span> Self-Study: Tidyverse</h2>
<p>The <code>tidyverse</code> package is a collection of packages that lets you import, manipulate, explore, visualize and model data in a harmonized and consistent way which helps you to be more productive.</p>
<p>Installing the <code>tidyverse</code> package:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb61"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
</div>
<p>To use the <code>tidyverse</code> package load it using the <code>library()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb62"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ stringr   1.5.1
✔ forcats   1.0.0     ✔ tibble    3.3.0
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<p><strong>Chick Weight Data</strong></p>
<p><code>R</code> comes with many datasets installed. We will use the <code>ChickWeight</code> dataset to learn (a little) about the tidyverse. The help system gives a basic summary of the experiment from which the data was collect:</p>
<blockquote>
<p><em>“The body weights of the chicks were measured at birth and every second day thereafter until day 20. They were also measured on day 21. There were four groups of chicks on different protein diets.”</em></p>
</blockquote>
<p>You can get more information, including references by typing:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb64"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(<span class="st">&quot;ChickWeight&quot;</span>)</span></code></pre></div>
</div>
<p><strong>The Data: </strong> There are 578 observations (rows) and 4 variables:</p>
<ul>
<li><code>Chick</code> – unique ID for each chick.</li>
<li><code>Diet</code> – one of four protein diets.</li>
<li><code>Time</code> – number of days since birth.</li>
<li><code>weight</code> – body weight of chick in grams.</li>
</ul>
<p>Note: <code>weight</code> has a lower case <code>w</code> (recall R is case sensitive).</p>
<p>Store the data locally:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb65"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>ChickWeight <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Chick, Diet, Time, weight) <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Chick, Diet, Time) <span class="sc">%&gt;%</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="st">&quot;DATA/ChickWeight.csv&quot;</span>)</span></code></pre></div>
</div>
<p>First we will import the data from a file called <code>ChickWeight.csv</code> using the <code>read_csv()</code> function from the <code>readr</code> package (part of the <code>tidyverse</code>). The first thing to do, outside of R, is to open the file <code>ChickWeight.csv</code> to check what it contains and that it makes sense. Now we can import the data as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb66"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>CW <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;DATA/ChickWeight.csv&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 578 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
dbl (4): Chick, Diet, Time, weight

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>If all goes well then the data is now stored in an R object called <code>CW</code>. If you get the following error message then you need to change the working directory to where the data is stored:</p>
<blockquote>
<p>Error: ‘ChickWeight.csv’ does not exist in current working directory …</p>
</blockquote>
<p><strong>Changing the working directory:</strong> In RStudio you can use the menu bar (“Session - Set Working Directory - Choose Directory…”). Alternatively, you can use the function <code>setwd()</code>. Last but not least, to avoid issues with brocken paths to files and data sets, use RStudios’ “Project” tools.</p>
<p><strong>Looking at the Dataset:</strong> To look at the data type just type the object (dataset) name:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb68"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>CW</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
   Chick  Diet  Time weight
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1    18     1     0     39
 2    18     1     2     35
 3    16     1     0     41
 4    16     1     2     45
 5    16     1     4     49
 6    16     1     6     51
 7    16     1     8     57
 8    16     1    10     51
 9    16     1    12     54
10    15     1     0     41
# ℹ 568 more rows</code></pre>
</div>
</div>
<p>If there are too many variables then not all them may be printed. To overcome this issue we can use the <code>glimpse()</code> function which makes it possible to see every column in your dataset (called a “data frame” in R speak).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb70"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(CW)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 578
Columns: 4
$ Chick  &lt;dbl&gt; 18, 18, 16, 16, 16, 16, 16, 16, 16, 15, 15, 15, 15, 15, 15, 15,…
$ Diet   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ Time   &lt;dbl&gt; 0, 2, 0, 2, 4, 6, 8, 10, 12, 0, 2, 4, 6, 8, 10, 12, 14, 0, 2, 4…
$ weight &lt;dbl&gt; 39, 35, 41, 45, 49, 51, 57, 51, 54, 41, 49, 56, 64, 68, 68, 67,…</code></pre>
</div>
</div>
<p>The function <code>View()</code> allows for a spread-sheet type of view on the data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb72"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(CW)</span></code></pre></div>
</div>
<section id="self-study-tidyverse-plotting-basics" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1"><span class="header-section-number">1.6.1</span> Self-Study: Tidyverse Plotting Basics</h3>
<p>To <strong>visualize</strong> the chick weight data, we will use the <code>ggplot2</code> package (part of the <code>tidyverse</code>). Our interest is in seeing how the <em>weight changes over time for the chicks by diet</em>. For the moment don’t worry too much about the details just try to build your own understanding and logic. To learn more try different things even if you get an error messages.</p>
<p>Let’s plot the weight data (vertical axis) over time (horizontal axis). Generally, <code>ggplot2</code> works in layers. The following codes generates an empty plot:</p>
<div class="cell" data-layout-align="center" data-fig.margin="true">
<div class="sourceCode" id="cb73"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># An empty plot</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight))  </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="Ch1_Intro2R_files/figure-html/emptyPlot-1.png" class="img-fluid" width="432" /></p>
<figcaption>Empty ggplot layer.</figcaption>
</figure>
</div>
</div>
</div>
<p>To the empty plot, one can add fuhrer layers:</p>
<div class="cell" data-layout-align="center" data-fig.margin="true">
<div class="sourceCode" id="cb74"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a scatter plot </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight)) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="Ch1_Intro2R_files/figure-html/emptyPlot2-1.png" class="img-fluid" width="432" /></p>
<figcaption>Adding a scatter plot layer to the empty ggplot layer.</figcaption>
</figure>
</div>
</div>
</div>
<p>Add color for <code>Diet</code>. The graph above does not differentiate between the diets. Let’s use a different color for each diet.</p>
<div class="cell" data-layout-align="center" data-fig.margin="true">
<div class="sourceCode" id="cb75"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding colour for diet</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW,<span class="fu">aes</span>(Time,weight,<span class="at">colour=</span><span class="fu">factor</span>(Diet))) <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="Ch1_Intro2R_files/figure-html/addColourPlot-1.png" class="img-fluid" width="432" /></p>
<figcaption>Adding a further layer for shown the effect of the Diet.</figcaption>
</figure>
</div>
</div>
</div>
<p>It is difficult to conclude anything from this graph as the points are printed on top of one another (with diet 1 underneath and diet 4 at the top).</p>
<p>To improve the plot, it will be handy to store <code>Diet</code> and <code>Time</code> as a <code>factor</code> variables.</p>
<p><strong>Factor Variables:</strong> Before we continue, we have to make an important change to the <code>CW</code> dataset by making <code>Diet</code> and <code>Time</code> <em>factor variables</em>. This means that R will treat them as categorical variables (see the <code>&lt;fct&gt;</code> variables below) instead of continuous variables. It will simplify our coding. The next section will explain the <code>mutate()</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb76"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>CW <span class="ot">&lt;-</span> <span class="fu">mutate</span>(CW, <span class="at">Diet =</span> <span class="fu">factor</span>(Diet))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>CW <span class="ot">&lt;-</span> <span class="fu">mutate</span>(CW, <span class="at">Time =</span> <span class="fu">factor</span>(Time))</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(CW)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 578
Columns: 4
$ Chick  &lt;dbl&gt; 18, 18, 16, 16, 16, 16, 16, 16, 16, 15, 15, 15, 15, 15, 15, 15,…
$ Diet   &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ Time   &lt;fct&gt; 0, 2, 0, 2, 4, 6, 8, 10, 12, 0, 2, 4, 6, 8, 10, 12, 14, 0, 2, 4…
$ weight &lt;dbl&gt; 39, 35, 41, 45, 49, 51, 57, 51, 54, 41, 49, 56, 64, 68, 68, 67,…</code></pre>
</div>
</div>
<p>The <code>facet_wrap()</code> function: To plot each diet separately in a grid using <code>facet_wrap()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb78"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding jitter to the points</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diet) <span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="Ch1_Intro2R_files/figure-html/ScatterPlot-1.png" class="img-fluid quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
<!-- To overcome the issue of ovelapping points we can ***jitter*** the points using  -->
<!-- `geom_jitter()`. Replace the `geom_point()` above with `geom_jitter()`. What do you -->
<!-- observe? -->
<!-- ```{r jitterPlot2} -->
<!-- # Adding jitter to the points -->
<!-- ggplot(CW, aes(Time, weight, colour=Diet)) + -->
<!--   geom_jitter() + -->
<!--   facet_wrap(~Diet) + -->
<!--   theme(legend.position = "bottom") -->
<!-- ``` -->
<p><strong>Interpretation:</strong> Diet 4 has the least variability but we can’t really say anything about the mean effect of each diet although diet 3 seems to have the highest.</p>
<p>Next we will plot the <strong>mean changes</strong> over time for each diet using the <code>stat_summary()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb79"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight, </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">group=</span>Diet, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>) </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="Ch1_Intro2R_files/figure-html/meanlinesPlot-1.png" class="img-fluid quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> We can see that diet 3 has the highest mean weight gains by the end of the experiment. However, we don’t have any information about the variation (uncertainty) in the data.</p>
<p>To see variation between the different diets we use <code>geom_boxplot</code> to plot a box-whisker plot. A note of caution is that the number of chicks per diet is relatively low to produce this plot.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb80"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diet) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Chick Weight over Time by Diet&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="Ch1_Intro2R_files/figure-html/boxPlot-1.png" class="img-fluid quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> Diet 3 seems to have the highest “average” weight gain but it has more variation than diet 4 which is consistent with our findings so far.</p>
<p>Let’s finish with a plot that you might include in a publication.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb81"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight, <span class="at">group=</span>Diet, </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diet) <span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_jitter() +</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Chick Weight over Time by Diet&quot;</span>) <span class="sc">+</span> </span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Time (days)&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Weight (grams)&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="Ch1_Intro2R_files/figure-html/finalPlot-1.png" class="img-fluid quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="self-study-tidyverse-data-wrangling-basics" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2"><span class="header-section-number">1.6.2</span> Self-Study: Tidyverse Data Wrangling Basics</h3>
<p>In this section we will learn how to wrangle (manipulate) datasets using the <code>tidyverse</code> package. Let’s start with the <code>mutate()</code>, <code>select()</code>, <code>rename()</code>, <code>filter()</code> and <code>arrange()</code> functions.</p>
<p><code>mutate()</code>: Adds a new variable (column) or modifies an existing one. We already used this above to create factor variables.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb82"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Added a column</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>CWm1 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(CW, <span class="at">weightKg =</span> weight<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>CWm1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 5
  Chick Diet  Time  weight weightKg
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;    &lt;dbl&gt;
1    18 1     0         39    0.039
2    18 1     2         35    0.035
3    16 1     0         41    0.041
# ℹ 575 more rows</code></pre>
</div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify an existing column</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>CWm2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(CW, <span class="at">Diet =</span> <span class="fu">str_c</span>(<span class="st">&quot;Diet &quot;</span>, Diet))</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>CWm2</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Diet   Time  weight
  &lt;dbl&gt; &lt;chr&gt;  &lt;fct&gt;  &lt;dbl&gt;
1    18 Diet 1 0         39
2    18 Diet 1 2         35
3    16 Diet 1 0         41
# ℹ 575 more rows</code></pre>
</div>
</div>
<p><code>select()</code>: Keeps, drops or reorders variables.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb86"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the weight variable from CWm1 using minus</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(CWm1, <span class="sc">-</span>weight)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Diet  Time  weightKg
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt;
1    18 1     0        0.039
2    18 1     2        0.035
3    16 1     0        0.041
# ℹ 575 more rows</code></pre>
</div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep variables Time, Diet and weightKg</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(CWm1, Chick, Time, Diet, weightKg)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Time  Diet  weightKg
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt;
1    18 0     1        0.039
2    18 2     1        0.035
3    16 0     1        0.041
# ℹ 575 more rows</code></pre>
</div>
</div>
<p><code>rename()</code>: Renames variables whilst keeping all variables.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb90"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">rename</span>(CW, <span class="at">Group =</span> Diet, <span class="at">Weight =</span> weight)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Group Time  Weight
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
1    18 1     0         39
2    18 1     2         35
3    16 1     0         41
# ℹ 575 more rows</code></pre>
</div>
</div>
<p><code>filter()</code>: Keeps or drops observations (rows).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb92"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(CW, Time<span class="sc">==</span><span class="dv">21</span> <span class="sc">&amp;</span> weight<span class="sc">&gt;</span><span class="dv">300</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  Chick Diet  Time  weight
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
1     7 1     21       305
2    29 2     21       309
3    21 2     21       331
# ℹ 5 more rows</code></pre>
</div>
</div>
<p>For comparing values in vectors use: <code>&lt;</code> (less than), <code>&gt;</code> (greater than), <code>&lt;=</code> (less than and equal to), <code>&gt;=</code> (greater than and equal to), <code>==</code> (equal to) and <code>!=</code> (not equal to). These can be combined logically using <code>&amp;</code> (and) and <code>|</code> (or).</p>
<p><code>arrange()</code>: Changes the order of the observations.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb94"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">arrange</span>(CW, Chick, Time)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Diet  Time  weight
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
1     1 1     0         42
2     1 1     2         51
3     1 1     4         59
# ℹ 575 more rows</code></pre>
</div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">arrange</span>(CW, <span class="fu">desc</span>(weight))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Diet  Time  weight
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
1    35 3     21       373
2    35 3     20       361
3    34 3     21       341
# ℹ 575 more rows</code></pre>
</div>
</div>
<p>What does the <code>desc()</code> do? Try using <code>desc(Time)</code>.</p>
<section id="the-pipe-operator" class="level4 unnumbered">
<h4 class="unnumbered">The pipe operator <code>%&gt;%</code></h4>
<p>In reality you will end up doing multiple data wrangling steps that you want to save. The pipe operator <code>%&gt;%</code> makes your code nice and readable:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb98"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>CW21 <span class="ot">&lt;-</span> CW <span class="sc">%&gt;%</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Weight =</span> weight) <span class="sc">%&gt;%</span> </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">&quot;Diet &quot;</span>, Diet))) <span class="sc">%&gt;%</span> </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Chick, Group, Time, Weight) <span class="sc">%&gt;%</span> </span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Chick, Time) </span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>CW21</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 95 × 4
  Chick Group  Time  Weight
  &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;  &lt;dbl&gt;
1     1 Diet 1 0         42
2     1 Diet 1 21       205
3     2 Diet 1 0         40
# ℹ 92 more rows</code></pre>
</div>
</div>
<p>Hint: To understand the code above we should read the pipe operator <code>%&gt;%</code> as “then”.</p>
<blockquote>
<p>Create a new dataset (object) called <code>CW21</code> using dataset <code>CW</code> <strong><em>then</em></strong> keep the data for days 0 and 21 <strong><em>then</em></strong> rename variable <code>weight</code> to <code>Weight</code> <strong><em>then</em></strong> create a variable called <code>Group</code> <strong><em>then</em></strong> keep variables <code>Chick</code>, <code>Group</code>, <code>Time</code> and <code>Weight</code> and <strong><em>then</em></strong> finally arrange the data by variables <code>Chick</code> and <code>Time</code>.</p>
</blockquote>
<p>This is the same code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb100"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>CW21 <span class="ot">&lt;-</span> CW <span class="sc">%&gt;%</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(., Time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(., <span class="at">Weight =</span> weight) <span class="sc">%&gt;%</span> </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(., <span class="at">Group=</span><span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">&quot;Diet &quot;</span>,Diet))) <span class="sc">%&gt;%</span> </span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(., Chick, Group, Time, Weight) <span class="sc">%&gt;%</span> </span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(., Chick, Time) </span></code></pre></div>
</div>
<p>The pipe operator, <code>%&gt;%</code>, replaces the dots (<code>.</code>) with whatever is returned from code preceding it. For example, the dot in <code>filter(., Time %in% c(0, 21))</code> is replaced by <code>CW</code>. The output of the <code>filter(...)</code> then replaces the dot in <code>rename(., Weight = weight)</code> and so on. Think of it as a data assembly line with each function doing its thing and passing it to the next.</p>
</section>
<section id="the-group_by-function" class="level4" data-number="1.6.2.1">
<h4 data-number="1.6.2.1"><span class="header-section-number">1.6.2.1</span> The <code>group_by()</code> function</h4>
<p>From the data visualizations above we concluded that the diet 3 has the highest mean and diet 4 the least variation. In this section, we will quantify the effects of the diets using <strong>summmary statistics</strong>. We start by looking at the number of observations and the mean by <strong>diet</strong> and <strong>time</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb101"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>mnsdCW <span class="ot">&lt;-</span> CW <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Diet, Time) <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">N =</span> <span class="fu">n</span>(), <span class="at">Mean =</span> <span class="fu">mean</span>(weight)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Diet, Time)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by &#39;Diet&#39;. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>mnsdCW</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 4
# Groups:   Diet [4]
  Diet  Time      N  Mean
  &lt;fct&gt; &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;
1 1     0        20  41.4
2 1     2        20  47.2
3 1     4        19  56.5
# ℹ 45 more rows</code></pre>
</div>
</div>
<p>For each distinct combination of <code>Diet</code> and <code>Time</code>, the chick weight data is summarized into the number of observations (<code>N</code>) and the mean (<code>Mean</code>) of <code>weight</code>.</p>
<p><strong>Further summaries:</strong> Let’s also calculate the standard deviation, median, minimum and maximum values but only at days 0 and 21.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb105"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>sumCW <span class="ot">&lt;-</span>  CW <span class="sc">%&gt;%</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Diet, Time) <span class="sc">%&gt;%</span> </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">Mean =</span> <span class="fu">mean</span>(weight),</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(weight),</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Median =</span> <span class="fu">median</span>(weight),</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(weight),</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(weight)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Diet, Time)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by &#39;Diet&#39;. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>sumCW</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
# Groups:   Diet [4]
  Diet  Time      N  Mean     SD Median   Min   Max
  &lt;fct&gt; &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1     0        20  41.4  0.995   41      39    43
2 1     21       16 178.  58.7    166      96   305
3 2     0        10  40.7  1.49    40.5    39    43
# ℹ 5 more rows</code></pre>
</div>
</div>
<p>Let’s make the summaries “prettier”, say, for a report or publication.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb109"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>) <span class="co"># to use the kable() function</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>prettySumCW <span class="ot">&lt;-</span> sumCW <span class="sc">%&gt;%</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">Mean (SD)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">str_c</span>(<span class="fu">format</span>(Mean, <span class="at">digits=</span><span class="dv">1</span>),</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot; (&quot;</span>, <span class="fu">format</span>(SD, <span class="at">digits=</span><span class="dv">2</span>), <span class="st">&quot;)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Range =</span> <span class="fu">str_c</span>(Min, <span class="st">&quot; - &quot;</span>, Max)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(Diet, Time, N, <span class="st">`</span><span class="at">Mean (SD)</span><span class="st">`</span>, Median, Range) <span class="sc">%&gt;%</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">arrange</span>(Diet, Time) <span class="sc">%&gt;%</span> </span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;latex&quot;</span>)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>prettySumCW</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Diet</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Time</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mean (SD)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Median</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">41 ( 0.99)</td>
<td style="text-align: right;">41.0</td>
<td style="text-align: left;">39 - 43</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">178 (58.70)</td>
<td style="text-align: right;">166.0</td>
<td style="text-align: left;">96 - 305</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">41 ( 1.5)</td>
<td style="text-align: right;">40.5</td>
<td style="text-align: left;">39 - 43</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">215 (78.1)</td>
<td style="text-align: right;">212.5</td>
<td style="text-align: left;">74 - 331</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">41 ( 1)</td>
<td style="text-align: right;">41.0</td>
<td style="text-align: left;">39 - 42</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">270 (72)</td>
<td style="text-align: right;">281.0</td>
<td style="text-align: left;">147 - 373</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">41 ( 1.1)</td>
<td style="text-align: right;">41.0</td>
<td style="text-align: left;">39 - 42</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">239 (43.3)</td>
<td style="text-align: right;">237.0</td>
<td style="text-align: left;">196 - 322</td>
</tr>
</tbody>
</table>


</div>
</div>
<!-- Eventually you should be able to produce a publication ready version as follows: -->
<!-- ```{r prettyKable, echo = FALSE} -->
<!-- library("knitr") -->
<!-- prettySumCW %>%  -->
<!-- kable("latex", booktabs = TRUE, linesep = "", align = "cccrc") %>%  -->
<!--   #kable_styling(position = "center") %>%  -->
<!--   row_spec(0, bold = TRUE) %>% -->
<!--   row_spec(c(2, 4, 6, 8), background = "lightgray") -->
<!--   # Uncomment below once bugs are fixed - https://github.com/haozhu233/kableExtra/issues/243 & 237 -->
<!--   # column_spec(1, bold = T) %>% -->
<!--   # collapse_rows(columns = 1, latex_hline = "none", valign = "top") -->
<!-- ``` -->
<p><strong>Interpretation:</strong> This summary table offers the same interpretation as before, namely that diet 3 has the highest mean and median weights at day 21 but a higher variation than group 4. However it should be noted that at day 21, diet 1 lost 4 chicks from 20 that started and diet 4 lost 1 from 10. This could be a sign of some health related issues.</p>
<!-- 
## Links 


### `R`-Intros {-}

* https://eddelbuettel.github.io/gsir-te/Getting-Started-in-R.pdf

* https://www.datacamp.com/courses/free-introduction-to-r

* https://swcarpentry.github.io/r-novice-gapminder/

* https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects



### Version Control (Git/GitHub)  {-}

* https://support.rstudio.com/hc/en-us/articles/200532077-Version-Control-with-Git-and-SVN

* http://happygitwithr.com/

* https://www.gitkraken.com/



### `R`-Communities  {-}

* https://rladies.org/
-->
</section>
</section>
</section>
<section id="self-study-gitgithub" class="level2" data-number="1.7">
<h2 data-number="1.7"><span class="header-section-number">1.7</span> Self-Study: Git/GitHub</h2>
<p>For this course, it is not required and not necessary to learn git. The GitHub assignment repository (see below) can be used simply in the browser. However, if you are interested in learning git, you can, of course, do so.</p>
<p>Links to good git introductions:</p>
<ul>
<li><a href="https://effective-programming-practices.vercel.app/git/index.html">Course Effective Programming Practices (Uni Bonn)</a></li>
<li><a href="http://happygitwithr.com/">http://happygitwithr.com/</a></li>
</ul>
</section>
<section id="in-class-coding-exercise-oct.-20" class="level2" data-number="1.8">
<h2 data-number="1.8"><span class="header-section-number">1.8</span> In Class Coding Exercise (Oct. 20)</h2>
<section id="marketing-campaign" class="level4 unnumbered">
<h4 class="unnumbered">Marketing Campaign</h4>
<ul>
<li>Sample size: <span class="math inline">\(n = 5\)</span> stores</li>
<li>Sales before the campaign: <span class="math display">\[
S_{i,1}=M_i + u_i
\]</span></li>
<li>Sales after the campaign: <span class="math display">\[
S_{i,2}=M_i + \Delta + v_i,
\]</span> where <span class="math inline">\(M_1,\dots,M_n\overset{\text{iid}}{\sim}M\)</span> are the individual “fixed effects” with <span class="math display">\[
M \sim \mathcal{N}\left(250,2\right)
\]</span> and <span class="math inline">\(u_{1},\dots,u_{n}\overset{\text{iid}}{\sim}u\)</span> and <span class="math inline">\(v_{1},\dots,v_{n}\overset{\text{iid}}{\sim}v\)</span> are iid error terms with <span class="math display">\[
u \sim \mathcal{N}\left(0,1\right)
\]</span> <span class="math display">\[
v \sim \mathcal{N}\left(0,1\right)
\]</span> and where <span class="math inline">\(\Delta\)</span> denotes the effect of the marketing campaign.</li>
</ul>
<p>Consider the difference sales for each store: <span class="math display">\[
X_i = S_{i,2}-S_{i,1},\quad i=1,\dots,n
\]</span> Note that <span class="math display">\[
X_i = S_{i,2}-S_{i,1}= \Delta + v_i - u_i,\quad i=1,\dots,n
\]</span> such that <span class="math display">\[
X_i \sim \mathcal{N}(\Delta,2),\quad i=1,\dots,n.
\]</span></p>
<p><strong>Tasks:</strong></p>
<ol type="1">
<li>Write a function that generates realizations of the iid random sample <span class="math inline">\(\{X_1,\dots,X_n\}\)</span> for a given value of <span class="math inline">\(\Delta\)</span> and of the sample size <span class="math inline">\(n\)</span>.
<ul>
<li>Plot your observed data <span class="math inline">\(\{X_{1,obs},\dots,X_{n,obs}\}\)</span> for <span class="math inline">\(\Delta=0\)</span> (no effect) and <span class="math inline">\(\Delta = 1.5\)</span> (positive effect)</li>
</ul></li>
<li>Estimate the effect of the marketing campaign <span class="math inline">\(\Delta\)</span> using the sample mean <span class="math inline">\(\bar{X}=n^{-1}\sum_{i=1}^nX_i.\)</span> Consider each of the scenarios <span class="math inline">\(\Delta=0\)</span> and <span class="math inline">\(\Delta=1.5\)</span> separately.</li>
<li>Compute the observed confidence interval <span class="math inline">\(\operatorname{CI}_{obs}\)</span> for (the usually unknown) <span class="math inline">\(\Delta.\)</span> Consider each of the scenarios <span class="math inline">\(\Delta=0\)</span> and <span class="math inline">\(\Delta=1.5\)</span> separately.</li>
<li>Repeatedly generate <span class="math inline">\(1000\)</span> realizations of the confidence interval <span class="math inline">\(\operatorname{CI}_{obs}\)</span> by repeatedly generating <span class="math inline">\(1000\)</span> realizations of the iid random sample <span class="math inline">\(\{X_1,\dots,X_n\}\)</span>.
<ul>
<li>What is the relative frequency of <span class="math inline">\(\operatorname{CI}\)</span> realizations containing <span class="math inline">\(\Delta\)</span>? Consider each of the scenarios <span class="math inline">\(\Delta=0\)</span> and <span class="math inline">\(\Delta=1.5\)</span> separately.</li>
</ul></li>
</ol>
<!-- ## Assignment 


Code functions to compute the following three summary statistics: 

* `myMean()` to compute the sample mean
* `myVariance()` to compute the sample variance
* `myRange()` to compute the range of values in a given sample

Do **not** use pre-implemented functions such as the `mean()`-function in `R`.

Apply each function using simulated data sets and compare the population (true) parameters with their sample versions. 

Provide also the mathematical formulas for each implemented summary statistic.


Link to your personal assignment repository:</br>
[https://classroom.github.com/a/5HB8NuPW](https://classroom.github.com/a/5HB8NuPW) 


Write up everything in **one** PDF document, e.g. using quarto and the provided `Template.qmd` file. 

Upload your PDF file to your assignment repository. Make sure that your PDF file names your (first, and last) name and the name of your GitHub account. -->
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-int-sidebar-title">Computer-Aided Statistical Analysis (B.Sc.)</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-int-navbar-title">Computer-Aided Statistical Analysis (B.Sc.)</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-int-next"><span class="chapter-number">2</span>  <span class="chapter-title">Linear Regression</span></span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-int-prev">Organization of the Course</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-int-sidebar:/index.htmlOrganization-of-the-Course">Organization of the Course</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-int-sidebar:/Ch1_Intro2R.html&lt;span-class=&#39;chapter-number&#39;&gt;1&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;`R`-Lab:-Introduction-to-`R`&lt;/span&gt;"><span class="chapter-number">1</span>  <span class="chapter-title"><code>R</code>-Lab: Introduction to <code>R</code></span></span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-int-sidebar:/Ch4_LinearRegression.html&lt;span-class=&#39;chapter-number&#39;&gt;2&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Linear-Regression&lt;/span&gt;"><span class="chapter-number">2</span>  <span class="chapter-title">Linear Regression</span></span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-int-sidebar:/Ch3_MatrixAlgebra.html&lt;span-class=&#39;chapter-number&#39;&gt;3&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Matrix-Algebra&lt;/span&gt;"><span class="chapter-number">3</span>  <span class="chapter-title">Matrix Algebra</span></span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-int-sidebar:/Ch5_Classification.html&lt;span-class=&#39;chapter-number&#39;&gt;4&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Classification&lt;/span&gt;"><span class="chapter-number">4</span>  <span class="chapter-title">Classification</span></span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-int-sidebar:/Ch6_ResamplingMethods.html&lt;span-class=&#39;chapter-number&#39;&gt;5&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Resampling-Methods&lt;/span&gt;"><span class="chapter-number">5</span>  <span class="chapter-title">Resampling Methods</span></span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-breadcrumbs-&lt;span-class=&#39;chapter-number&#39;&gt;1&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;`R`-Lab:-Introduction-to-`R`&lt;/span&gt;"><span class="chapter-number">1</span>  <span class="chapter-title"><code>R</code>-Lab: Introduction to <code>R</code></span></span></p>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-metatitle"><span class="chapter-number">1</span>  <span class="chapter-title"><code>R</code>-Lab: Introduction to <code>R</code></span> – Computer-Aided Statistical Analysis (B.Sc.)</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-twittercardtitle"><span class="chapter-number">1</span>  <span class="chapter-title"><code>R</code>-Lab: Introduction to <code>R</code></span> – Computer-Aided Statistical Analysis (B.Sc.)</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-ogcardtitle"><span class="chapter-number">1</span>  <span class="chapter-title"><code>R</code>-Lab: Introduction to <code>R</code></span> – Computer-Aided Statistical Analysis (B.Sc.)</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-metasitename">Computer-Aided Statistical Analysis (B.Sc.)</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-twittercarddesc"></span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="quarto-ogcardddesc"></span></p>
</div>
</section>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a  href="/index.html" class="pagination-link" aria-label="Organization of the Course">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Organization of the Course</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a  href="/Ch4_LinearRegression.html" class="pagination-link" aria-label="Linear Regression">
        <span class="nav-page-text"><span class='chapter-number'>2</span>  <span class='chapter-title'>Linear Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->

</body>

</html>
